FROM rasa/rasa:3.6.20-spacy-en

WORKDIR /app

COPY . .

# Train a fresh model every build (uses your config.yml, data/, etc.)
RUN rasa train

# Optional: Rename the new model for consistency
RUN mv models/*.tar.gz models/latest.tar.gz

EXPOSE 5005

CMD ["run", "--enable-api", "--cors", "*", "-m", "models/latest.tar.gz", "--endpoints", "endpoints.yml"]